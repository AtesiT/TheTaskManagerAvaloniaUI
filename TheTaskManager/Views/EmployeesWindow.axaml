<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="using:TheTaskManager.ViewModels"
        x:Class="TheTaskManager.Views.EmployeesWindow"
        x:DataType="vm:EmployeesViewModel"
        Title="Управление сотрудниками"
        Width="900" Height="600"
        MinWidth="800" MinHeight="500"
        WindowStartupLocation="CenterOwner">

    <Window.Styles>
        <Style Selector="TextBlock.label">
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Foreground" Value="#555"/>
            <Setter Property="Margin" Value="0,0,0,5"/>
        </Style>
        
        <Style Selector="TextBox, ComboBox">
            <Setter Property="Margin" Value="0,0,0,12"/>
        </Style>
        
        <Style Selector="DataGridRow:selected /template/ Rectangle#BackgroundRectangle">
            <Setter Property="Fill" Value="#1976D2"/>
        </Style>
    </Window.Styles>

    <Grid RowDefinitions="Auto,*,Auto" Background="#F5F5F5">
        
        <!-- Заголовок -->
        <Border Grid.Row="0" Background="#1976D2" Padding="20">
            <Grid ColumnDefinitions="*,Auto">
                <StackPanel>
                    <TextBlock Text="👥 Управление сотрудниками"
                               FontSize="22"
                               FontWeight="Bold"
                               Foreground="White"/>
                    <TextBlock Text="Добавление, редактирование и удаление сотрудников"
                               FontSize="13"
                               Foreground="#B3FFFFFF"
                               Margin="0,5,0,0"/>
                </StackPanel>
                
                <StackPanel Grid.Column="1" Orientation="Horizontal" Spacing="10">
                    <Button Content="➕ Добавить"
                            Command="{Binding AddEmployeeCommand}"
                            Background="#4CAF50"
                            Foreground="White"
                            Padding="15,8"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- Основной контент -->
        <Grid Grid.Row="1" ColumnDefinitions="*,350" Margin="15">
            
            <!-- Список сотрудников -->
            <Border Grid.Column="0" 
                    Background="White" 
                    CornerRadius="10" 
                    Padding="15"
                    Margin="0,0,10,0">
                <Grid RowDefinitions="Auto,*">
                    
                    <!-- Поиск -->
                    <TextBox Grid.Row="0"
                             Text="{Binding SearchText}"
                             Watermark="🔍 Поиск по имени, должности, отделу..."
                             Margin="0,0,0,15"/>
                    
                    <!-- Таблица сотрудников -->
                    <DataGrid Grid.Row="1"
                              ItemsSource="{Binding Employees}"
                              SelectedItem="{Binding SelectedEmployee}"
                              AutoGenerateColumns="False"
                              IsReadOnly="True"
                              CanUserResizeColumns="True"
                              GridLinesVisibility="Horizontal"
                              BorderThickness="1"
                              BorderBrush="#E0E0E0"
                              CornerRadius="6">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="ФИО" 
                                                Binding="{Binding FullName}" 
                                                Width="*"/>
                            <DataGridTextColumn Header="Должность" 
                                                Binding="{Binding Position}" 
                                                Width="120"/>
                            <DataGridTextColumn Header="Отдел" 
                                                Binding="{Binding Department}" 
                                                Width="100"/>
                            <DataGridCheckBoxColumn Header="Активен" 
                                                    Binding="{Binding IsActive}" 
                                                    Width="70"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </Border>

            <!-- Панель редактирования -->
            <Border Grid.Column="1" 
                    Background="White" 
                    CornerRadius="10" 
                    Padding="20">
                <Grid RowDefinitions="Auto,*,Auto">
                    
                    <TextBlock Grid.Row="0"
                               Text="📝 Данные сотрудника"
                               FontSize="16"
                               FontWeight="SemiBold"
                               Margin="0,0,0,15"/>
                    
                    <ScrollViewer Grid.Row="1">
                        <StackPanel>
                            
                            <TextBlock Text="ФИО *" Classes="label"/>
                            <TextBox Text="{Binding EditFullName}"
                                     Watermark="Введите ФИО..."
                                     IsEnabled="{Binding IsEditing}"/>
                            
                            <TextBlock Text="Должность" Classes="label"/>
                            <ComboBox ItemsSource="{Binding Positions}"
                                      SelectedItem="{Binding EditPosition}"
                                      IsEditable="True"
                                      IsEnabled="{Binding IsEditing}"
                                      HorizontalAlignment="Stretch"/>
                            
                            <TextBlock Text="Отдел" Classes="label"/>
                            <ComboBox ItemsSource="{Binding Departments}"
                                      SelectedItem="{Binding EditDepartment}"
                                      IsEditable="True"
                                      IsEnabled="{Binding IsEditing}"
                                      HorizontalAlignment="Stretch"/>
                            
                            <TextBlock Text="Email" Classes="label"/>
                            <TextBox Text="{Binding EditEmail}"
                                     Watermark="email@company.ru"
                                     IsEnabled="{Binding IsEditing}"/>
                            
                            <TextBlock Text="Телефон" Classes="label"/>
                            <TextBox Text="{Binding EditPhone}"
                                     Watermark="+7 (999) 123-45-67"
                                     IsEnabled="{Binding IsEditing}"/>
                            
                            <CheckBox Content="Активный сотрудник"
                                      IsChecked="{Binding EditIsActive}"
                                      IsEnabled="{Binding IsEditing}"
                                      Margin="0,10,0,0"/>
                            
                        </StackPanel>
                    </ScrollViewer>
                    
                    <!-- Кнопки -->
                    <StackPanel Grid.Row="2" Spacing="10" Margin="0,15,0,0">
                        
                        <!-- Кнопки режима редактирования -->
                        <StackPanel Orientation="Horizontal" 
                                    Spacing="10"
                                    IsVisible="{Binding IsEditing}">
                            <Button Content="💾 Сохранить"
                                    Command="{Binding SaveEmployeeCommand}"
                                    Background="#4CAF50"
                                    Foreground="White"
                                    Padding="15,8"
                                    HorizontalAlignment="Stretch"/>
                            <Button Content="Отмена"
                                    Command="{Binding CancelEditCommand}"
                                    Padding="15,8"/>
                        </StackPanel>
                        
                        <!-- Кнопки режима просмотра -->
                        <StackPanel Orientation="Horizontal" 
                                    Spacing="10"
                                    IsVisible="{Binding !IsEditing}">
                            <Button Content="✏️ Изменить"
                                    Command="{Binding EditEmployeeCommand}"
                                    Background="#FF9800"
                                    Foreground="White"
                                    Padding="15,8"
                                    IsEnabled="{Binding SelectedEmployee, Converter={x:Static ObjectConverters.IsNotNull}}"/>
                            <Button Content="🗑️ Удалить"
                                    Command="{Binding DeleteEmployeeCommand}"
                                    Background="#F44336"
                                    Foreground="White"
                                    Padding="15,8"/>
                        </StackPanel>
                    </StackPanel>
                </Grid>
            </Border>
        </Grid>

        <!-- Нижняя панель -->
        <Border Grid.Row="2" 
                Background="White" 
                Padding="15"
                BorderThickness="0,1,0,0"
                BorderBrush="#E0E0E0">
            <Grid ColumnDefinitions="*,Auto">
                <TextBlock Text="{Binding Employees.Count, StringFormat='Всего сотрудников: {0}'}"
                           VerticalAlignment="Center"
                           Foreground="#666"/>
                <Button Grid.Column="1"
                        Content="Закрыть"
                        Command="{Binding CloseCommand}"
                        Padding="20,8"/>
            </Grid>
        </Border>
    </Grid>
</Window>